show databases;

create database employee;

use employee;

create table emp(
	emp_no int primary key,
    first_name varchar(10) not null,
    last_name varchar(10),
    salary int not null,
    birth_date date,
    gender varchar(6) ,
    joining_date date,
    department varchar(30));

INSERT INTO emp (emp_no, first_name, Last_name,salary, birth_date, gender,joining_date,department)
VALUES 
(1001, 'James', 'Bond', 45300, '1998-01-19', 'M', '2020-11-29', 'Marketing'),
(1002, 'Robert', 'Lee', 69410, '1998-09-02', 'M', '2019-12-26', 'IT'),
(1003, 'Mary', 'Wood', 39518, '1997-11-07', 'F', '2019-09-12', 'Business Development'),
(1004, 'John', 'Cole', 36264, '1999-02-01', 'M', '2021-04-14', 'HR'),
(1005, 'Jennifer', 'Gill', 48941, '1996-06-05', 'F', '2019-06-28', 'Marketing'),
(1006, 'Michael', 'Watts', 23800, '1999-04-16', 'M', '2022-06-09', 'HR'),
(1007, 'David', 'Mills', 39400, '1998-04-26', 'M', '2021-10-17', 'IT'),
(1008, 'William', 'Hill', 26392, '1999-10-21', 'M', '2019-09-30', 'Business Development'),
(1009, 'Linda', 'Potter', 55231, '1998-01-24', 'F', '2021-08-07', 'Finance'),
(1010, 'Richard', 'Martin', 25600, '1996-08-07', 'M', '2021-03-23', 'IT'),
(1011, 'Susan', 'Hall', 54152, '1999-12-27', 'F', '2020-08-07', 'Finance'),
(1012, 'Joseph', 'Turner', 60556, '1997-05-13', 'M', '2019-09-02', 'Marketing'),
(1013, 'Mary', 'Gill', 58246, '1999-01-21', 'F', '2021-04-30', 'Business Development'),
(1014, 'Thomas', 'Ryan', 23676, '1996-10-12', 'M', '2022-03-02', 'IT'),
(1015, 'Charles', 'Williams', 57226, '2000-01-29', 'M', '2019-11-05', NULL),
(1016, 'Jessica', 'Clark', 50000, '2000-01-25', 'F', '2020-01-24', 'IT'),
(1017, 'Nancy', 'Parker', 66900, '1996-10-24', 'F', '2022-01-09', 'Finance'),
(1018, 'Betty', 'Barker', 35288, '1998-11-13', 'F', '2019-12-26', 'HR'),
(1019, 'Chrisr', 'Gibson', 59341, '1998-04-23', 'M', '2019-05-02', 'Marketing'),
(1020, 'Daniel', 'Elliott', 44012, '1999-01-21', 'M', '2023-01-08', 'IT'),
(1021, 'David', 'Mills', 785211, '1998-01-24', 'M', '2019-12-26', 'IT'),
(1022, 'Sarah', 'Harrison', 44692, '1996-03-20', 'F', '2020-05-03', 'Finance'),
(1023, 'Matthew', 'Hill', 41365, '1998-05-16', 'M', '2019-05-23', 'IT'),
(1024, 'Anthony', 'Miller', 56794, '1996-06-30', 'M', '2019-02-28', 'Business Development'),
(1025, 'Mark', 'Wood', 65120, '1998-10-29', 'M', '2020-07-30', 'Business Development'),
(1026, 'Elizabeth', 'Walker', 47030, '1998-08-11', 'F', '2021-06-18', NULL),
(1027, 'Barbara', 'Anderson', 56452, '1999-12-27', 'F', '2021-03-14', 'HR'),
(1028, 'Jessica', 'Clark', 63836, '1998-01-24', 'F', '2021-05-23', 'IT'),
(1029, 'Nancy', 'Cole', 63669, '2000-01-26', 'F', '2019-12-26', 'Finance'),
(1030, 'Joe', 'Brooks', 44000, '1999-08-05', 'M', '2021-03-09', 'Business Development');

-- 1) Write a SQL query to count the number of duplicate first name as duplicate_count in the employee table. 
select first_name, count(*) as duplicate_count from emp group by first_name having count(*) > 1;


-- 2) Find the departments with more than 5 employees as total employees from the employee table. 
select department, count(*) as total_employees from emp group by department having count(*) > 5;


-- 3) Determine the department with an average salary greater than 50000 as average_salary from the employee table. 
select department, avg(salary) as average_salary from emp group by department having avg(salary) > 50000;


-- 4) Determine the department with at least 3 employees earning a salary of 30000 or more total_employees from as the employee table 
select department, count(*) as total_employees from emp where salary >= 30000 group by department having count(*) >= 3;


-- 5) Find the departments with a maximum salary greater than 60000 as max_salary from the employee table. 
select department, max(salary) as max_salary from emp group by department having max(salary) > 60000;


-- 6) Find the department where the highest salary (as highest_salary) is at least twice the lowest salary (as lowest_salary) in the employee table. 
select department, 
       max(salary) as highest_salary, 
       min(salary) as lowest_salary
from emp group by department having max(salary) >= 2 * min(salary);


-- 7) Determine the department with at least 5 employees (as total_employees) where the total salary expense (as total_salary_expense) is 
-- greater than 100000 in the employee table. 
select department, 
       count(*) as total_employees, 
       sum(salary) as total_salary_expense
from emp group by department having count(*) >= 5 and sum(salary) > 100000;


-- 8) Determine the department where the average salary (as average_salary) is within the range of 20000 to 50000 (inclusive) in the employee table. 
select department, avg(salary) as average_salary from emp group by department having avg(salary) between 20000 and 50000;


-- 9) Determine the departments with more than 4 employees (as total_employees) where the difference between the maximum and minimum salary is greater 
-- than 25000 (salary_difference) from the employee table.
select department, count(*) as total_employees, max(salary) - min(salary) as salary_difference from emp group by department 
	having count(*) > 4 and (max(salary) - min(salary)) > 25000;

